logging {
    level  = "info"
    format = "logfmt"
}

# Discover only the namespace weâ€™re allowed to read.
discovery.kubernetes "pods_ns" {
    role       = "pod"
    namespaces = ["team-breaking-build"]
}

# ---- LOGS --------------------------------------------------------------
loki.source.kubernetes "pods" {
    targets    = discovery.kubernetes.pods_ns.targets
    forward_to = [loki.write.local.receiver]
}

loki.write "local" {
    endpoint {
        url = "http://loki-gateway.team-breaking-build.svc.cluster.local/loki/api/v1/push"
    }
}